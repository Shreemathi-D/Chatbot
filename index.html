<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Assistant</title>
    <!-- Tailwind CSS CDN (for development; see production note below) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Azure Speech SDK -->
    <script src="https://aka.ms/csspeech/jsbrowserpackageraw"></script>
    <!-- Chat.js -->
    <script src="js/chat_1.js"></script>
    <!-- Google Fonts (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom scrollbar styles */
        .scrollbar-thin {
            scrollbar-width: thin;
        }
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        .scrollbar-thumb-blue-300::-webkit-scrollbar-thumb {
            background-color: #93c5fd;
            border-radius: 4px;
        }
        .scrollbar-track-blue-50::-webkit-scrollbar-track {
            background-color: #eff6ff;
            border-radius: 4px;
        }
        /* Chat message styles */
        .user-message, .assistant-message, .system-message {
            margin-bottom: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
        }
        .user-message {
            background-color: #e6f3ff;
            text-align: right;
        }
        .assistant-message {
            background-color: #f0f0f0;
        }
        .system-message {
            background-color: #fff3cd;
            text-align: center;
        }
        /* Ensure button text and icons are centered */
        button {
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        /* Ensure video fills circular container */
        #remoteVideo video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 9999px; /* Matches rounded-full */
        }
        /* Feature item styles */
        .feature-item {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 250, 252, 0.8));
            border: 1px solid rgba(139, 92, 246, 0.15);
            border-radius: 16px;
            padding: 20px 24px; /* Fixed typo */
            margin-bottom: 18px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.08);
        }
        .feature-item:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 1), rgba(251, 250, 255, 0.95));
            border-color: rgba(139, 92, 246, 0.3);
            transform: translateX(12px) scale(1.02);
            box-shadow: 0 12px 32px rgba(139, 92, 246, 0.15);
        }
        .feature-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        .feature-item:hover::before {
            opacity: 1;
        }
        .feature-text {
            font-size: 1rem;
            color: #374151;
            font-weight: 500;
            line-height: 1.5;
        }
    </style>
</head>
<body class="h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 overflow-hidden font-['Inter']">
    <!-- Menu Button (for all screen sizes) -->
    <button id="mobileMenuButton" class="fixed top-6 left-6 z-50 p-3 bg-white rounded-xl shadow-lg border border-blue-100 hover:bg-blue-50 transition-colors">
        <svg class="w-5 h-5 text-slate-700" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
    </button>

    <div class="flex h-screen">
        <!-- Benefits Sidebar -->
        <div id="sidebar" class="fixed transition-transform duration-300 ease-in-out z-40 -translate-x-full w-80 bg-white/95 backdrop-blur-xl border-r border-blue-100 shadow-xl h-full flex flex-col">
            <div class="p-6 flex-shrink-0 border-b border-blue-50">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-3">
                        <div class="p-2 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-xl">
                            <svg class="w-6 h-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
                            </svg>
                        </div>
                        <h3 class="features-title text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">Key Benefits</h3>
                    </div>
                    <button id="closeSidebar" class="p-1 hover:bg-gray-100 rounded-lg">
                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <p class="features-subtitle text-slate-600 text-sm leading-relaxed">
                    Optimize and automate your inventory operations with AI-powered tools
                </p>
            </div>
            <div class="flex-1 overflow-y-auto p-6 scrollbar-thin scrollbar-thumb-blue-300 scrollbar-track-blue-50">
                <div class="space-y-4">
                    <div class="feature-item">
                        <div class="feature-text">Real-time stock monitoring for all inventory items</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-text">Quickly raise and manage restocking tickets</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-text">Log new inventory entries with voice or text</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-text">View recent inventory logs and updates instantly</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-text">Track and manage open inventory tickets</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-text">Analyze sales trends by date and region</div>
                    </div>
                    <div class="feature-item">
                        <div class="feature-text">Get insights on top-performing regions and clients</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Overlay for sidebar -->
        <div id="mobileOverlay" class="fixed inset-0 bg-black/20 backdrop-blur-sm z-30 hidden" onclick="document.getElementById('sidebar').classList.add('-translate-x-full'); this.classList.add('hidden');"></div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col h-full">
            <!-- Header -->
            <header class="bg-white/90 backdrop-blur-xl border-b border-blue-100 shadow-sm flex-shrink-0">
                <div class="px-8 py-4">
                    <div class="flex items-center justify-center gap-4">
                        <div class="p-3 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl shadow-lg">
                            <svg class="w-8 h-8 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
                            </svg>
                        </div>
                        <h1 class="text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent">Inventory Assistant</h1>
                    </div>
                </div>
            </header>

            <!-- Assistant Avatar Area -->
            <div class="flex-1 flex items-center justify-center px-8 py-6 relative min-h-0">
                <div class="relative">
                    <div class="w-64 h-64 lg:w-80 lg:h-80 relative">
                        <div id="remoteVideo" class="w-full h-full rounded-full bg-gradient-to-br from-blue-100 to-indigo-200 border-4 border-blue-200 shadow-2xl transition-all duration-500 relative overflow-hidden">
                            <div id="liveCaption" class="absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-white/95 backdrop-blur-md px-6 py-3 rounded-full text-sm font-medium text-slate-700 shadow-lg border border-blue-100 hidden">
                                Processing inventory query...
                            </div>
                        </div>
                        <div class="absolute -top-2 -right-2">
                            <div id="statusIndicator" class="w-6 h-6 rounded-full border-4 border-white shadow-lg bg-slate-400"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="bg-white/90 backdrop-blur-xl border-t border-blue-100 shadow-lg flex-shrink-0">
                <div class="px-8 py-4">
                    <div class="flex gap-4 mb-4">
                        <input
                            id="userMessageBox"
                            type="text"
                            placeholder="Ask about inventory levels, locations, or reports..."
                            class="flex-1 px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-slate-800 placeholder:text-slate-500"
                            disabled
                        />
                        <button
                            id="sendMessage"
                            class="px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-lg hover:shadow-xl flex items-center justify-center"
                            disabled
                        >
                            Send
                        </button>
                    </div>
                    <div class="flex flex-wrap gap-2 justify-center">
                        <button
                            id="startSession"
                            onclick="try { window.startSession(); console.log('startSession called'); } catch(e) { console.error('startSession error:', e); }"
                            class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-md hover:shadow-lg text-sm justify-center"
                        >
                            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 010 1.972l-11.54 6.347a1.125 1.125 0 01-1.667-.986V5.653z" />
                            </svg>
                            Start Session
                        </button>
                        <button
                            id="microphone"
                            class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-md hover:shadow-lg text-sm justify-center"
                            disabled
                            onclick="try { window.microphone(); console.log('microphone called'); } catch(e) { console.error('microphone error:', e); }"
                        >
                            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z" />
                            </svg>
                            Start Mic
                        </button>
                        <button
                            id="stopSpeaking"
                            class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-orange-600 to-amber-600 text-white rounded-lg hover:from-orange-700 hover:to-amber-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-md hover:shadow-lg text-sm justify-center"
                            disabled
                            onclick="try { window.stopSpeaking(); console.log('stopSpeaking called'); } catch(e) { console.error('stopSpeaking error:', e); }">

                            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 7.5A2.25 2.25 0 017.5 5.25h9a2.25 2.25 0 012.25 2.25v9a2.25 2.25 0 01-2.25 2.25h-9a2.25 2.25 0 01-2.25-2.25v-9z" />
                            </svg>
                            Stop
                        </button>
                        <!-- <button
                            
                            class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-slate-600 to-gray-600 text-white rounded-lg hover:from-slate-700 hover:to-gray-700 transition-all duration-200 font-medium shadow-md hover:shadow-lg text-sm justify-center">
                            id="clearChatHistory"

                            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                            </svg>
                            Clear
                        </button> -->
                        <button
                            id="clearChatHistory"
                            onclick="try { window.clearChatHistory(); console.log('clearChatHistory called'); } catch(e) { console.error('clearChatHistory error:', e); }"
                            class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-slate-600 to-gray-600 text-white rounded-lg hover:from-slate-700 hover:to-gray-700 transition-all duration-200 font-medium shadow-md hover:shadow-lg text-sm justify-center"
                        >
                        <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                            </svg>
                        </button>
                        <button
                            id="toggleChat"
                            onclick="try { window.toggleChat(); console.log('toggleChat called'); } catch(e) { console.error('toggleChat error:', e); }"
                            class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-purple-600 to-violet-600 text-white rounded-lg hover:from-purple-700 hover:to-violet-700 transition-all duration-200 font-medium shadow-md hover:shadow-lg text-sm justify-center"
                        >
                            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97c-.814-.265-1.587-.81-2.145-1.607C2.475 18.564 2 17.433 2 16.5V5.25c0-2.485 2.015-4.5 4.5-4.5h10.5c2.485 0 4.5 2.015 4.5 4.5v11.25zm-4.5-11.25H6.75c-.621 0-1.125.504-1.125 1.125v11.625c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V5.625c0-.621-.504-1.125-1.125-1.125z" />
                            </svg>
                            Show Transcriptions
                        </button>
                        <button
                            id="stopSession"
                            class="flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-red-600 to-rose-600 text-white rounded-lg hover:from-red-700 hover:to-rose-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-md hover:shadow-lg text-sm justify-center"
                            onclick="try { window.stopSession(); console.log('stopSession called'); } catch(e) { console.error('stopSession error:', e); }"
                            disabled
                        >
                            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                            End Session
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Transcription Panel -->
        <div id="chatHistoryPanel" class="fixed top-0 right-0 w-80 h-screen bg-white/95 backdrop-blur-xl border-l border-blue-100 shadow-2xl z-50 flex flex-col hidden">
            <div class="p-6 border-b border-blue-100">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-slate-800">Conversation History</h3>
                    <button id="closeTranscription" class="p-2 hover:bg-slate-100 rounded-lg transition-colors">
                        <svg class="w-5 h-5 text-slate-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
            <div id="transcriptionText" class="flex-1 p-6 overflow-y-auto text-sm text-slate-700 leading-relaxed scrollbar-thin scrollbar-thumb-blue-300 scrollbar-track-blue-50">
                <div class="text-slate-500 text-center py-8">
                    Conversation transcripts will appear here...
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden elements for compatibility -->
    <div id="chatHistory" class="hidden" aria-live="polite" aria-atomic="false" role="log"></div>
</body>
</html>
